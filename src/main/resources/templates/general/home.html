<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UBeli - Homepage</title>
    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div th:replace="fragments/navbar :: navbar"></div>

    <main class="container">

        <section class="hero-banner">
        
            <div th:if="${not #lists.isEmpty(listBoosted)}" class="banner-container">
                
                <button class="nav-btn prev" onclick="moveSlide(-1)">&#10094;</button>
    
                <div th:each="p, iterStat : ${listBoosted}" 
                     class="banner-slide fade"
                     th:classappend="${iterStat.index == 0} ? 'active-slide' : ''"> 
                     
                     <div class="banner-content">
                        <div class="banner-text">
                            <span class="promo-badge">üî• Sedang Hangat</span>
                            <h1 th:text="${p.namaProduk}">Nama Produk</h1>
                            <p th:text="${p.deskripsi}">Deskripsi...</p>
                            <a th:href="@{/produk/{id}(id=${p.produkId})}" class="btn-cek">Lihat Produk</a>
                        </div>
    
                        <div class="banner-img-box">
                            <img th:if="${not #lists.isEmpty(p.listFoto)}" 
                                 th:src="${p.listFoto[0].urlFoto}" class="banner-img-real">
                            <div th:if="${#lists.isEmpty(p.listFoto)}" class="banner-img-fallback">No Image</div>
                        </div>
                    </div>
                </div>
    
                <button class="nav-btn next" onclick="moveSlide(1)">&#10095;</button>
    
                <div class="dots-container">
                    <span th:each="p, iterStat : ${listBoosted}" 
                          class="dot" 
                          th:classappend="${iterStat.index == 0} ? 'active-dot' : ''"
                          th:onclick="'currentSlide(' + ${iterStat.index + 1} + ')'"></span>
                </div>
                
            </div>
    
            <div th:if="${#lists.isEmpty(listBoosted)}" class="banner-placeholder-static">
                <div class="banner-content-static">
                    <h2>Promo Spesial Minggu Ini!</h2>
                    <p>Temukan barang bekas berkualitas dengan harga mahasiswa.</p>
                </div>
            </div>
    
        </section>

        <section class="categories">
            <a th:href="@{/katalog/kategori/10003}" class="cat-item">
            <div class="cat-icon">üì±</div>
            <span>Elektronik</span>
        </a>

        <a th:href="@{/katalog/kategori/10004}" class="cat-item">
            <div class="cat-icon">üëï</div>
            <span>Pakaian</span>
        </a>

        <a th:href="@{/katalog/kategori/10001}" class="cat-item">
            <div class="cat-icon">üè†</div>
            <span>Furnitur</span>
        </a>

        <a th:href="@{/katalog/kategori/10002}" class="cat-item">
            <div class="cat-icon">üìö</div>
            <span>Buku</span>
        </a>

        </section>

        <section class="product-section">
            <div class="section-header">
                <h2>Produk terpopuler</h2>
                <a href="/katalog" class="lihat-semua">Lihat semua ></a>
            </div>

            <div class="product-grid">
                
                <div th:each="p : ${produkList}" class="product-card">
                    
                    <div class="product-image-placeholder">
                        <span>Foto Produk</span>
                    </div>

                    <div class="product-details">
                        <span class="product-cat" th:text="${p.kategori != null ? p.kategori.namaKategori : 'Tanpa Kategori'}"></span>
                        
                        <a th:href="@{/produk/{id}(id=${p.produkId})}" class="product-title" th:text="${p.namaProduk}">
                            Contoh Nama Produk Yang Agak Panjang Sedikit
                        </a>
                        <div class="price-row">
                            <span class="price">Rp <span th:text="${#numbers.formatDecimal(p.harga, 0, 'COMMA', 0, 'POINT')}">20.000.000</span></span>
                            <button class="btn-wishlist-card" disabled
                                    th:title="${wishlistProdukIds.contains(p.produkId) 
                                            ? 'Ada di wishlist' 
                                            : 'Tambahkan lewat halaman detail'}">

                                <i class="fa-heart"
                                th:classappend="${wishlistProdukIds.contains(p.produkId) 
                                                    ? ' fas active' 
                                                    : ' far'}">
                                </i>

                            </button>
                        </div>
                    </div>
                </div>

                <div class="product-card" th:if="${produkList == null or produkList.empty}">
                    <div class="product-image-placeholder" style="background: #e1e5ea;">Dummy 1</div>
                    <div class="product-details">
                        <span class="product-cat">Elektronik</span>
                        <a href="#" class="product-title">iPhone 17 Pro Max Dummy</a>
                        <div class="price-row">
                            <span class="price">Rp 20.000.000</span>
                            <button class="btn-wishlist-card"><i class="far fa-heart"></i></button>
                        </div>
                    </div>
                </div>
                
            </div>
        </section>

        <section class="product-section">
             <div class="section-header">
                <h2>Kamu pasti suka</h2>
                <a href="/katalog" class="lihat-semua">Lihat semua ></a>
            </div>
            <div class="product-grid">
                <div th:each="p : ${produkList}" class="product-card">
                    
                    <div class="product-image-placeholder">
                        <span>Foto Produk</span>
                    </div>

                    <div class="product-details">
                        <span class="product-cat" th:text="${p.kategori != null ? p.kategori.namaKategori : 'Tanpa Kategori'}"></span>
                        
                        <a th:href="@{/produk/{id}(id=${p.produkId})}" class="product-title" th:text="${p.namaProduk}">
                            Contoh Nama Produk Yang Agak Panjang Sedikit
                        </a>
                        <div class="price-row">
                            <span class="price">Rp <span th:text="${#numbers.formatDecimal(p.harga, 0, 'COMMA', 0, 'POINT')}">20.000.000</span></span>
                            <button class="btn-wishlist-card" disabled
                                    th:title="${wishlistProdukIds.contains(p.produkId) 
                                            ? 'Ada di wishlist' 
                                            : 'Tambahkan lewat halaman detail'}">

                                <i class="fa-heart"
                                th:classappend="${wishlistProdukIds.contains(p.produkId) 
                                                    ? ' fas active' 
                                                    : ' far'}">
                                </i>

                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <footer style="text-align: center; padding: 20px; margin-top: 40px; background: #fff;">
        &copy; 2023 UBeli. All rights reserved.
    </footer>

    <script>
        let slideIndex = 1;
        
        // Cek apakah ada slide sebelum menjalankan fungsi
        if (document.getElementsByClassName("banner-slide").length > 0) {
            showSlides(slideIndex);
            
            // Auto Play setiap 5 detik
            setInterval(function() {
                moveSlide(1);
            }, 5000); 
        }
    
        function moveSlide(n) {
            showSlides(slideIndex += n);
        }
    
        function currentSlide(n) {
            showSlides(slideIndex = n);
        }
    
        function showSlides(n) {
            let i;
            let slides = document.getElementsByClassName("banner-slide");
            let dots = document.getElementsByClassName("dot");
            
            if (n > slides.length) {slideIndex = 1}     
            if (n < 1) {slideIndex = slides.length}
            
            for (i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";   
            }
            
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active-dot", "");
            }
            
            slides[slideIndex-1].style.display = "flex"; // Pastikan display flex agar layout rapi
            
            dots[slideIndex-1].className += " active-dot";
        }
    </script>
</body>
</html>